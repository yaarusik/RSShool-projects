<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

	<title>reveal.js</title>

	<link rel="stylesheet" href="dist/reset.css" />
	<link rel="stylesheet" href="dist/reveal.css" />
	<link rel="stylesheet" href="dist/theme/black.css" />

	<!-- Theme used for syntax highlighted code -->
	<link rel="stylesheet" href="plugin/highlight/monokai.css" />
	<link rel="stylesheet" href="css/presentation.css" />

</head>

<body>
	<div class="reveal">
		<div class="slides">
			<section class="slide__one">
				<h2>Canvas</h2>
				<div>Interaction with elements on the Canvas</div>
				<div><img src="assets/canvas.jpg" alt="" /></div>
			</section>
			<section class="slide__two">
				<h2> Work plan</h2>
				<div class="slide__two-plan">
					<div>1. About canvas technology </div>
					<div>2. Canvas coordinate system </div>
					<div>3. Responsivness</div>
					<div>4. Placing and drawing elements </div>
					<div>5. Search for rendered objects </div>
				</div>

			</section>
			<section class='slide__free'>
				<h3>About Canvas technology</h3>

				<div style="font-size: 35px">
					Canvas is an HTML5 element that provides a simple and powerful
					way to display graphics and draw using JavaScript. For each Canvas
					element, you can use a context in which JavaScript commands are
					invoked to draw on the Canvas

				</div>
			</section>
			<section class="slide__four">
				<section class="slide__four-vertical">
					<h3>Context</h3>
					<div>However, the &lt;canvas&gt; element itself doesn’t have a drawing tool. It’s
						just a container for graphics. To draw on the &lt;canvas&gt; element you
						need to use the following script — getContext. </div>
				</section>
				<section>
					<div>getContext()</div>
					<pre data-id="code-animation"><code class="hljs" data-trim data-line-numbers>
            const canvas = document.createElement("canvas");
            document.body.append(canvas);
            const context = canvas.getContext("2d");
            </code></pre>
					<div>This script returns an object that provides methods and properties for
						drawing on the &lt;canvas&gt; element</div>
				</section>
				<section>
					<div> Свойство fillStyle и метод fillRect()</в>

						<pre data-id="code-animation"><code class="hljs" data-trim data-line-numbers>
            canvas.width = 800;
            canvas.height = 600;
            canvas.style.background = "lightblue";
            canvas.style.border = "1px solid black";
            context.fillStyle = "green";
            context.fillRect(100, 100, 100, 100);
            // draws a filled rectangle
            // whose starting point corresponds to the x, y coordinates
            //size is determined by the width and height parameters
            </code></pre>
						<img src="./assets/picture1.png" width="300" alt="">
				</section>
			</section>
			<section class='slide__five'>
				<section>
					<h3>Canvas coordinate system </h3>
					<div>Canvas
						technology has a modified coordinate system. Unlike the Cartesian system, in canvas it starts from the top
						left corner</div>
					<img src="./assets/picture2.png" width='1400' alt="">
				</section>
			</section>
			<section class="slide__six">
				<section>
					<h2>Responsiveness in canvas</h2>

					<img width="800" src="./assets/fix.gif">
				</section>
				<section>
					<div> To make a canvas responsive, set the following property on the canvas element</div>
					<pre data-id="code-animation"><code class="hljs" data-trim data-line-numbers>
            context.style.width = "100%";
            </code></pre>
					<img width="800" src="./assets/adaptive.gif">
				</section>
			</section>
			<section class="slide__seven">
				<section>
					<h3>How to work with images in canvas</h3>
				</section>
				<section>
					<h3>Create JavaScript object Image</h3>
					<pre data-id="code-animation"><code class="hljs" data-trim data-line-numbers>
            let img= new Image(); 
            img.src = 'image.png'; 
            </code></pre>
				</section>
				<section>
					<div>Draw an image on the canvas using the drawImage function</div>
					<pre data-id="code-animation"><code class="hljs" data-trim data-line-numbers>
            drawImage(image, x, y, width, height) 
            //image - image object. 
            // x and y are the coordinates of the top left corner 
            //of the image,
            //width и height - size of image,     
            </code></pre>
				</section>
				<section>
					<div>Use a construct for loading an
						image asynchronously</div>
					<pre data-id="code-animation"><code class="hljs" data-trim data-line-numbers>
            let img= new Image(); 
            img.onload = () => {   }  
            img.src = 'myImage.png';  
            </code></pre>
					<div>
					</div>
				</section>
				<section>
					<pre data-id="code-animation"><code class="hljs" data-trim data-line-numbers>
            canvas.width = 1600; canvas.style.width = "100%";
            canvas.height = 1200; canvas.style.maxWidth = "1600px";
            const image = new Image(); 
            image.onload = () => {
            context.drawImage(image, 0, 0, canvas.width, canvas.height);}
            image.src = "./assets/gameMap.jpg"; 
            </code></pre>
					<img src="./assets/bcg.gif" alt="">
				</section>
			</section>
			<section class="slide__eight">
				<section>
					<div>Drawing a fragment of an image</div>
					<pre data-id="code-animation"><code class="hljs" data-trim data-line-numbers>
          drawImage(image, sx, sy, swidth, sheight, x, y, width, height)
          // sx, sy -  coordinates of the starting point of the crop
          //swidth, sheight - size of the cropped image 
          //x, y - initial position on canvas
          //width, height - size of the cropped 
          //images rendered in Canvas
          const image = new Image();
          image.onload = () => { context.drawImage(
              image, 400, 400, 200, 200, 100, 100, 300, 300);};
          image.src = "./assets/gameMap.jpg";
          </code></pre>
					<div>One of the main features of the drawImage method is the ability to crop images and display only part of
						them. To do this, the method uses additional parameters.</div>
				</section>
				<section>
					<div>Result</div>
					<img width='200' src="./assets/cutPic.png" alt="">
					<img width='600' src="./assets/MAP.png" alt="">
					<div>Cropped image on the left, original image on the right. Inside it is circled in red square what was cut
						out </div>
				</section>
			</section>
			<section class="slide__nine">
				<section>
					<h3>Search for rendered objects on the canvas</h3>
				</section>
				<section data-background="./assets/mapInterface.gif">
				</section>
				<section>
					<h3> Implements asynchronous loading of
						images using a promise</h3>
					<pre data-id="code-animation"><code class="hljs" data-trim data-line-numbers>
            public loadImage(src) {
              return new Promise((resolve) => {
                const image = new Image();
                image.src = src;
                image.onload = () => {
                  resolve(image);
                };
              });
            }
            </code></pre>
				</section>
				<section>
					<h3>Implements image drawing</h3>
					<pre data-id="code-animation"><code class="hljs" data-trim data-line-numbers>
            private drawImage(ctx, loadImages) {
              Promise.all(loadImages).then(responses => {
                responses.forEach((img, index) => {
                  const item = this.imagesOptions[index];
                  if (item.type === "button") {
                    const cutPicture = new CutPicture(img, item.sx, item.sy, item.swidth, item.sheight, item.x, item.y, item.width, item.height);
                    cutPicture.draw(ctx);
                  } else {
                    const btn = new Picture(img, item.x, item.y, item.width, item.height);
                    btn.draw(ctx);
                  } }); });
            }
            </code></pre>
					<div>
						The PromiseAll method helps me implement asynchronous loading
						of images on a canvas sequentially.
					</div>
				</section>

			</section>
			<section classs="slide__ten">
				<section>
					<h3>How to make the interface clickable? </h3>
					<div style="text-align: left;">
						1. We need to find our buttons in canvas. <br>
						2. Add events to them
					</div>
				</section>
				<section>
					<div>CanvasMoveHundler</div>
					<pre data-id="code-animation"><code class="hljs" data-trim data-line-numbers>
            private canvasMoveHundler(event, canvas, buttons) {
              //event == mousemove
              buttons.forEach(btn => {
                const scaleCoords = this.scaleCoords(btn);
                if (this.determineCoords(event, scaleCoords)) {
                  this.buttonsHover(btn, btn.stepY);
                  this.changeAnimation(btn, true);
                } else {
                  this.buttonsHover(btn, 0);
                  this.changeAnimation(btn, false);
                }
              });
            }
            </code></pre>
					<div>The method tracks the movement of the mouse cursor in the Canvas.</div>
				</section>
				<section>
					<div>DetermineCoords</div>
					<pre data-id="code-animation"><code class="hljs" data-trim data-line-numbers>
            private determineCoords(e, scaleCoords) {
              const rect = this.canvas.node.getBoundingClientRect();
              const mouseX = e.clientX - rect.left;
              const mouseY = e.clientY - rect.top;
              // mouseX, mouseY - mouse position
              const { currentX, currentW, currentY, currentH }= scaleCoords;
              // currentX, currentY, currentW, currentH - current element 
              // position and its size
              return mouseX >= currentX && mouseX < (currentX + currentW) &&
               mouseY >= currentY && mouseY < currentY + currentH;
            }
            </code></pre>
					<div> Determines whether the position of the mouse
						cursor coincides with the coordinates of the rendered button </div>
					<div>
					</div>
				</section>
			</section>
			<section class="slide__eleven">
				<section>
					<h3>Problem</h3>
					<div style="margin-bottom: 10px;"> When you change the width or
						height of the screen, the position of the buttons may change. Then the
						buttons will have a different width, height and coordinates.</div>
					<h3>Solution</h3>
					<div> I set ‘window’ - resize event and inside it
						called the canvasScale function and tracked how many times the
						width and height changed when screen changed. </div>
				</section>
				<section>
					<pre data-id="code-animation"><code class="hljs" data-trim data-line-numbers>
            private canvasScale(canvas) {
              const widthContainer = getComputedStyle(canvas).width;
              const heightContainer = getComputedStyle(canvas).height;

              this.curWidthK = canvas.width / parseInt(widthContainer);
              this.curHeightK = canvas.height / parseInt(heightContainer);
            }
            </code></pre>
					<div>After learning how many times the width and height (curWidthK,
						curHeightK) changed, I improved the expression for calculating the
						position of the buttons.</div>
				</section>
				<section>
					<div>ScaleCoords method</div>
					<pre data-id="code-animation"><code class="hljs" data-trim data-line-numbers>
            private scaleCoords(btn: IPictures) {
              return {
                currentX: btn.x / this.curWidthK,
                currentW: btn.width / this.curWidthK,
                currentY: btn.y / this.curHeightK,
                currentH: btn.height / this.curHeightK
              };
            }
            </code></pre>
					<div>Problem solved - profit!</div>
				</section>
			</section>
			<section class='slide__twelve'>
				<h3>Сonclusion</h3>
				Canvas is powerful tool for creating user interfaces for games
				and applications. It responds quickly to events triggered by user
				actions. And its content can be updated at any time.
			</section>
		</div>

		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,

				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [RevealMarkdown, RevealHighlight, RevealNotes],
			});
		</script>
</body>

</html>